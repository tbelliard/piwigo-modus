function rvas_get_scaled_size(e,c){var a=e.w/c.w,b=e.h/c.h;if(a>1||b>1){if(a>b){return{w:c.w/c.dpr,h:Math.floor(e.h/a/c.dpr)}}else{return{w:Math.floor(e.w/b/c.dpr),h:c.h/c.dpr}}}return{w:Math.round(e.w/c.dpr),h:Math.round(e.h/c.dpr)}}function rvas_get_available_size(){var c=$("#theImage").width(),e=1,b;if("innerHeight" in window){b=window.innerHeight;if(document.documentElement.clientWidth>window.innerWidth&&window.innerWidth){e=document.documentElement.clientWidth/window.innerWidth}b=Math.floor(b*e)}else{b=document.documentElement.offsetHeight}var a=b-Math.ceil($("#theImage").offset().top);var d=window.devicePixelRatio&&window.devicePixelRatio>1?window.devicePixelRatio:1;c=Math.floor(c*d);a=Math.floor(a*d);document.cookie="phavsz="+c+"x"+a+"x"+d+";path="+RVAS.cp;return{w:c,h:a,dpr:d,zoom:e}}function rvas_choose(l){var e,b=rvas_get_available_size(),a=$("#theMainImage"),g=true;for(var h=0;h<RVAS.derivatives.length;h++){var k=RVAS.derivatives[h];if(k.w>b.w*b.zoom||k.h>b.h*b.zoom){e=k;break}else{e=k}}if(e){if(b.dpr>1){var j=rvas_get_scaled_size(e,b);if(a.attr("width")&&b.zoom==1){var f=j.h/a.height(),c=l?1.25:1.15;if(f>=1&&f<c||(f<1&&f>1/c&&a.width()<b.w/b.dpr)){return}}if(!a.data("natural-w")||a.data("natural-w")<e.w){a.attr("width",j.w).attr("height",j.h).attr("src",e.url).removeAttr("usemap").data("natural-w",e.w)}else{a.attr("width",j.w).attr("height",j.h);g=false}}else{if(a.attr("width")){var f=e.h/a.height(),c=l?2:1.15;if(f>=1&&f<c||(f<1&&f>1/c&&a.width()<b.w)){return}}a.attr("src",e.url).attr("usemap","#map"+e.type)}if(g){$("#derivativeSwitchBox .switchCheck").css("visibility","hidden");$("#derivativeChecked"+e.type).css("visibility","visible")}}}$(document).ready(function(){if(window.changeImgSrc){RVAS.changeImgSrcOrig=changeImgSrc;changeImgSrc=function(){RVAS.disable=1;RVAS.changeImgSrcOrig.apply(undefined,arguments)}}$(window).resize(function(){var a=$("body").width(),b=$(document.documentElement);if(document.location.search.indexOf("slideshow")==-1){if(a<1262){b.removeClass("wide")}else{b.addClass("wide")}}if(RVAS.disable){rvas_get_available_size()}else{rvas_choose()}});$("#theMainImage").click(function(d){if(!$(this).attr("usemap")&&d.clientY){var c=(d.pageX-$(this).offset().left)/$(this).width(),b=d.pageY-$(this).offset().top;if(c<0.3){if($("#linkPrev").length&&b>15){window.location=$("#linkPrev").attr("href")}}else{if(c>0.7){if($("#linkNext").length&&b>15){window.location=$("#linkNext").attr("href")}}else{if(b/$(this).height()<0.5&&b>15){var a=$(".pwg-icon-arrow-n").parent("a").attr("href");if(a){window.location=a}}}}}})});